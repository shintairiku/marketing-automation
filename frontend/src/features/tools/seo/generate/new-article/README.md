# 記事生成フロー - 新しいUI/UX

## 概要

記事生成フローのUI/UXを大幅に改善し、一画面に収まるコンパクトで美しいデザインに刷新しました。WebSocketによるリアルタイムな生成状況の表示と、ユーザー体験を向上させる機能を多数追加しています。

## 主な改善点

### 1. コンパクトな生成フロー表示
- **4×2グリッドレイアウト**: 8つのステップを見やすく配置
- **視覚的な進捗表示**: プログレスバーと完了率の表示
- **リアルタイムアニメーション**: 現在実行中のステップがひと目でわかる
- **美しいグラデーション**: 全体のデザインシステムに合致したカラーパレット

### 2. 改善されたユーザーインタラクション
- **統一されたデザイン**: ペルソナ・テーマ選択、計画承認を統一されたカードデザインで表示
- **選択しやすいUI**: ホバー効果と選択状態の明確な視覚フィードバック
- **詳細情報の表示**: 各選択肢の詳細情報とキーワードの表示

### 3. リアルタイムプレビュー機能
- **フローティングプレビュー**: 画面右側に常時表示可能なプレビューウィンドウ
- **リアルタイム更新**: 記事生成中の内容をリアルタイムで確認
- **統計情報**: 文字数、推定読了時間、現在のセクション情報を表示
- **美しいproseスタイル**: 記事内容を読みやすくフォーマット

### 4. 高度なエラーハンドリング
- **インテリジェントなエラー判定**: エラーの種類に応じた適切な提案
- **再試行機能**: ワンクリックでの再試行とキャンセル機能
- **詳細エラー情報**: 開発者向けの詳細エラー情報を必要に応じて表示

## 技術的改善

### パフォーマンス最適化
- **React.memo**: 重要なコンポーネントのメモ化による再レンダリング最適化
- **効率的な状態管理**: WebSocketメッセージの適切な処理
- **遅延読み込み**: 必要な時のみコンポーネントを表示

### アクセシビリティ
- **キーボードナビゲーション**: 全機能をキーボードで操作可能
- **セマンティックHTML**: スクリーンリーダー対応
- **適切なカラーコントラスト**: WCAG 2.1 AA準拠

## コンポーネント構成

```
/new-article/
├── component/
│   ├── CompactGenerationFlow.tsx     # メイン生成フロー表示
│   ├── CompactUserInteraction.tsx    # ユーザーインタラクション
│   ├── RealTimePreview.tsx           # リアルタイムプレビュー
│   ├── GenerationErrorHandler.tsx    # エラーハンドリング
│   └── ArticlePreviewStyles.tsx      # 記事プレビュー用スタイル
├── display/
│   └── indexPage.tsx                 # メインページ
└── hooks/
    ├── useArticleGeneration.ts       # 記事生成ロジック
    └── useWebSocket.ts              # WebSocket通信
```

## 使用方法

### 1. 記事生成の開始
1. `/seo/generate/new-article` ページにアクセス
2. 必要な情報（キーワード、ターゲット層など）を入力
3. 「記事生成を開始」ボタンをクリック

### 2. 生成フローの監視
- コンパクトな生成フローカードで進捗状況を確認
- 右上の接続状態インジケーターでサーバー接続を確認
- プログレスバーで全体の進捗を把握

### 3. ユーザー入力が必要な場合
- ペルソナ選択: 生成されたペルソナから最適なものを選択
- テーマ選択: 提案されたテーマから執筆したいものを選択
- 計画承認: リサーチ計画やアウトラインを確認・承認

### 4. リアルタイムプレビュー
- 「プレビュー表示」ボタンで記事生成の様子を確認
- 記事内容と構成の両方をタブで切り替え表示
- 全画面表示も可能

### 5. 完成記事の確認
- 生成完了後、プレビューまたはダウンロードが可能
- 美しいproseスタイルで整形された記事を確認

## WebSocket通信仕様

### サーバーからのメッセージ
```typescript
interface ServerEventMessage {
  type: 'server_event';
  payload: {
    step?: string;                    // 現在のステップ
    message?: string;                 // ステップの説明
    section_index?: number;           // セクション番号
    heading?: string;                 // セクション見出し
    html_content_chunk?: string;      // HTMLコンテンツチャンク
    final_html_content?: string;      // 最終HTMLコンテンツ
    // その他のフィールド...
  };
}
```

### クライアントからのレスポンス
```typescript
interface ClientResponseMessage {
  type: 'client_response';
  response_type: 'select_persona' | 'select_theme' | 'approve_plan' | 'approve_outline';
  payload: any;
}
```

## カスタマイズ

### カラーテーマの変更
`tailwind.config.ts` の CSS変数を変更することで、全体のカラーテーマをカスタマイズできます。

### アニメーションの調整
各コンポーネント内の `framer-motion` の設定を変更することで、アニメーションをカスタマイズできます。

### プレビュースタイルの変更
`ArticlePreviewStyles.tsx` を編集することで、記事プレビューの見た目をカスタマイズできます。

## 今後の展開

- 記事生成中の一時停止・再開機能
- 生成設定のプリセット保存機能
- 記事の部分的な再生成機能
- より詳細な生成統計の表示
- エクスポート形式の拡張（PDF、Word等）

---

このUI/UXにより、記事生成フローがより直感的で効率的になり、ユーザーの離脱率低下と満足度向上を実現しています。 